# API v1 Smoke тесты

### Smoke подключение к серверу

/api/1/:sellerID/item → статус != 5xx

### Smoke создание объявления

POST /api/1/item → статус = 200


---


# API v1 Позитивные тест-кейсы

## Успешное создание объявления

Полное описание:
1. Отправить POST /api/1/item с валидными полями: -
sellerID: валидный ID - name: строка - price: положительное число -
statistics: likes, viewCount, contacts ≥ 0
2. Проверить статус 200. 
3. Проверить, что поле "status" присутствует и содержит текст "Сохранили
объявление". 
4. Извлечь ID через extract_ad_id(). 
5. Убедиться, что ID != None. 
6. DELETE для cleanup.

Ожидаемый результат: - Создание успешно. - ID корректно извлечён.

---

##  Получение объявления по ID

1.  Создать объявление.
2.  Извлечь ID.
3.  GET /api/1/item/{id}.
4.  Статус = 200.
5.  Ответ может быть объектом или массивом.
6.  В ответе id == созданному.
7.  Удалить объявление.

------------------------------------------------------------------------

##  Получение объявлений продавца

1.  Создать объявление.
2.  GET /api/1/seller/{sellerID}.
3.  Статус 200.
4.  Ответ --- массив.
5.  Удаление.

------------------------------------------------------------------------

##  Получение статистики

1.  Создать объявление.
2.  GET /api/1/stat/{id}.
3.  Статус 200 или 404.
4.  Если 200 — проверить структуру статистики.
5.  Удалить объявление.

---
# API v1 Негативные тест-кейсы

##  Отрицательные цены

Параметры: -1, -100, -999999 Шаги: 1. price = negative 2. POST
/api/1/item Ожидаемый результат: статус 400. 

---

## Невалидные sellerID при GET

Параметры: - 999999 → 404 - 0 → 404 - -123 → 404

---

##  Отрицательные likes

##  Отрицательные просмотры

## Отрицательные контакты

##  Отрицательный sellerID

##  Нулевые значения

sellerID=0 → 400\
price=0 → 200\
likes=0 → 200\
viewCount=0 → 200\
contacts=0 → 200\
---

##  Несколько отрицательных значений одновременно

Все отрицательные поля → 400.

---

##  Комбинации отрицательных значений

Любая комбинация → статус 400.

---
# API v1 — Security тесты

## XSS проверки

Тестовые значения: -
-    ```{=html}
     <script>alert(1)</script>
     ```
-   `<img src=x onerror=alert(1)>`
- {=html} 

Шаги:

1.  POST /api/1/item с опасным name.

2.  Если 200 — GET созданного объявления.

3.  Проверить отсутствие script/onerror.

---

## SQL Injection проверки

Тест: "'; DROP TABLE ads; --" Статус должен быть 400 или безопасное
сохранение.
---

## Ограничения длины name

-   1 символ → 200

-   255 символов → 200

-   256 → 400

-   1000 → 400

-   пусто → 400

-   пробелы → 400

---

## Огромные sellerID

-   999999999999999999
-   2\^31
-   2\^63
-   строка большого числа Статус должен быть 400 или корректная
    обработка.
---

## Спецсимволы

-   quotes OK

-   double quotes OK

-   backslashes OK

-   ```{=html}
    <html>  → 400
    ```
   

-   \${javascript} → 200

-   SQL-style text → 200



---

# API v1 — Интеграционные тесты

## Полный цикл объявления

1.  POST создать.
2.  GET получить.
3.  DELETE удалить.
4.  GET убедиться что удалено. Ожидаемый результат:

-   200 на создание
-   200 на получение
-   200 на удаление
-   404/400 после удаления

---

# API v2

## Позитивные тесты

### Успешное удаление

1.  POST создать
2.  DELETE удалить
3.  GET проверить удаление (404/400)

### Получение статистики

1.  POST создать
2.  GET /api/2/stat/{id}
3.  Если 200 --- проверить структуру

------------------------------------------------------------------------

## Негативные тесты

### Удаление несуществующего ID

Статус: 400 или 404

### Статистика несуществующего ID

Статус: 400 или 404

------------------------------------------------------------------------

## Интеграция

### Согласованность статистики v1/v2

-   Оба статуса должны совпадать
-   При 200 --- данные согласованы

### Полный цикл с удалением через v2

Шаги:
1. POST создать
2. GET получить
3. GET статистика v2 
4. DELETE v2
5. GET проверить удаление

------------------------------------------------------------------------

## Smoke

### Smoke удаление

POST → DELETE

### Smoke статистика

GET /api/2/stat/test_id → статус != 5xx

